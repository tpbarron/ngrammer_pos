<p>Click the chart for more information about Apple's stock.</p>

<p>NEW YORK (CNNMoney) -- Shares of Apple set another all-time high on Friday on growing expectations for an upcoming wave of new gadgets.</p>

<p>Apple's (AAPL, Fortune 500) stock rose as high as $648.19, besting the previous high set in April, before closing the day just a few cents lower at $648.11. The company's shares blew through a series of record highs in the first four months of the year, but had then been in a funk since May, when Apple reported that its iPhone sales had plateaued.</p>

<p>Apple badly missed Wall Street's sales and profit forecasts last quarter and delivered a weak financial outlook for the current quarter.</p>

<p>But the anticipated September launch of the new iPhone, coupled with rumors of a smaller iPad -- and perpetual Apple TV whispers -- have lifted the stock once again.</p>

<p>Apple is believed to be planning an event for Sept. 12 at which it is likely to unveil its next smartphone. The new iPhone's upgrades are expected to include 4G wireless support and a larger screen.</p>

<p>The iPhone has become by far the largest driver of Apple's success. In quarters that Apple launches an updated smartphone, the company has typically posted record sales and profit. Last year, after Apple launched the iPhone 4S, it had the second-most profitable quarter in U.S. corporate history.</p>

<p>As Apple's stock rises, it is approaching another milestone. If shares reach $663.68, Apple will become the most valuable company of all time, eclipsing the record Microsoft set in late 1999, according to Howard Silverblatt, S&P's senior index analyst.</p>

<p>Apple is already the most valuable company in the world, but with a market capitalization of $607.5 billion, it is still shy of Microsoft's record $618.9 billion. Microsoft set that benchmark on Dec. 30, 1999, at the height of the dot-com bubble.</p>

<p>Microsoft (MSFT, Fortune 500) now trades at a valuation of around $260 billion.</p>

<p>Despite Apple's stunning share price rise, the company's stock gains haven't kept pace with its earnings. That means Apple's shares are still relatively cheap. Trading at 14 times this year's earnings forecast, it has a price-to-earnings ratio far below that of some tech stocks, including Facebook (FB), Groupon (GRPN) and even Zynga (ZNGA), whose stock has plunged sharply.</p>

