<p>WASHINGTON (CNNMoney) -- Microsoft has saved nearly $7 billion off its U.S. tax bill since 2009 by using loopholes to shift profits offshore, a Senate panel said in a report released Thursday.</p>

<p>Hewlett-Packard also avoided paying taxes through a series of loans, some spanning 30 months, that shifted billions of dollars between two offshore subsidiaries, according to the Senate panel.</p>

<p>The Permanent Subcommittee on Investigations reviewed tax loopholes used by dozens of companies in the high-tech industry to shift profits offshore. But it focused on moves by Microsoft (MSFT, Fortune 500) and Hewlett-Packard (HPQ, Fortune 500), according to Sen. Carl Levin, the Michigan Democrat who runs the panel.</p>

<p>The Republicans on the panel, including ranking member Tom Coburn of Oklahoma, said they support the report while stressing it found nothing illegal. Coburn said the report shows the need for reforms to the tax code and lower corporate tax rates.</p>

<p>The Senate investigation, which included subpoenas and voluntary correspondence with the companies, provided an in-depth look into how the companies set up and use overseas tax shelters, as well as the impact on government coffers.</p>

<p>Levin acknowledged that Microsoft has broken no laws. But he blamed a loose tax code, Congress and tax officials for allowing the loopholes.</p>

<p>"The tax practices and gimmicks range from egregious to dubious validity," Levin said. "What these gimmicks do is shift the burden of taxes to citizens that don't use armies of lawyers and accountants and subsidiaries to lower their tax bill."</p>

<p>In the case of Microsoft, the company transferred nearly half of its net revenue from U.S. retail sales to a Puerto Rican subsidiary between 2009 and 2011. That saved the firm $4.5 billion in U.S. taxes, according to the panel.</p>

<p>Related: Tax battle: Obama vs. Romney</p>

<p>Tapping a different tax loophole, Microsoft saved another $2.43 billion by "checking a box" on an IRS form that tells tax officials to ignore "passive" income from royalties -- on things such as patents -- moved to its offshore subsidiaries.</p>

<p>Microsoft Vice President of Worldwide Tax William J. Sample defended the companies' use of legal tax avoidance maneuvers, saying it helps them be competitive overseas and creates jobs in the United States.</p>

<p>"One of the business imperatives faced by Microsoft and many U.S.-based businesses today is that we must operate in foreign markets in order to compete and succeed as a company," Sample said in remarks prepared for delivery at the hearing. "Foreign revenue growth helps support the growth of our U.S. operations, creating additional U.S. jobs and supporting an economic ripple effect that leads to greater growth in local communities."</p>

<p>In the case of Hewlett-Packard, the investigation found the computer maker whittles down its cash kept in the United States by tapping a series of loans made from subsidiaries in Belgium and the Cayman Islands.</p>

<p>For example, in 2009, Hewlett-Packard held $12.5 billion in foreign cash, but only $800 million in the United States. It only pays taxes on the U.S. portion, while tapping a series of ongoing "short-term" loans that, taken together, stretched for 30 straight months, according to the panel.</p>

<p>"This pattern of keeping most of HP's cash offshore and obtaining loans from its offshore entities to fund its U.S. operations was also carried out in earlier years," the report said.</p>

<p>Hewlett-Packard spokesman Howard Clabo said the company has complied with the U.S. tax code and its auditor Ernst & Young has signed off on the accuracy of its financial statement. He said the IRS has permanent offices at two of its facilities and has never raised any concerns about its programs.</p>

<p>" We are disappointed to see what appears to be a politically motivated attack on one of America's largest employers," Clabo said.</p>

